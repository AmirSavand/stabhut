(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"5c0e":function(t,c,e){"use strict";e.r(c);var i=e("ofXK"),n=e("3Pt+"),a=e("tyNb"),s=e("6NWb"),b=e("oW1M"),r=function(t){return t[t.CARD=1]="CARD",t}({}),o=e("lRx4"),d=e("phuL"),l=e("H+bZ"),f=e("8B4y"),u=e("IBXX"),p=e("fXoL");const g=["contentInput"];function h(t,c){if(1&t&&(p.Pb(0,"span",25),p.zc(1),p.Ob()),2&t){const t=p.Zb(2);p.Ab(1),p.Ac(t.card.content)}}function m(t,c){1&t&&(p.Pb(0,"small",30),p.zc(1,"This field is required"),p.Ob())}function O(t,c){if(1&t&&(p.Pb(0,"div",26),p.Nb(1,"textarea",27,28),p.xc(3,m,2,0,"small",29),p.Ob()),2&t){const t=p.Zb(2);p.Ab(1),p.Eb("is-invalid",t.content.hasError("required")),p.fc("formControl",t.content),p.Ab(2),p.fc("ngIf",t.content.hasError("required"))}}function v(t,c){if(1&t&&(p.Pb(0,"span"),p.zc(1),p.Ob()),2&t){const t=p.Zb(2);p.Ab(1),p.Ac(t.getUser(t.card.assignee).username)}}function P(t,c){1&t&&(p.Pb(0,"span",31),p.zc(1,"No one"),p.Ob())}function A(t,c){1&t&&(p.Pb(0,"span",31),p.zc(1,"No label"),p.Ob())}function x(t,c){if(1&t&&(p.Pb(0,"span"),p.zc(1),p.ac(2,"date"),p.Ob()),2&t){const t=p.Zb(2);p.Ab(1),p.Ac(p.cc(2,1,t.card.updated,"hh:MM a"))}}function z(t,c){1&t&&(p.Pb(0,"span",31),p.zc(1,"Never"),p.Ob())}function C(t,c){if(1&t){const t=p.Qb();p.Pb(0,"div",32),p.Pb(1,"a",33),p.Xb("click",(function(){return p.rc(t),p.Zb(2).editCard(!1)})),p.zc(2,"Cancel"),p.Ob(),p.Pb(3,"button",34),p.Xb("click",(function(){p.rc(t);const c=p.Zb(2);return c.update({content:c.content.value}),c.isEditing=!1})),p.zc(4,"Update "),p.Ob(),p.Ob()}if(2&t){const t=p.Zb(2);p.Ab(3),p.fc("disabled",t.content.hasError("required"))}}function I(t,c){if(1&t){const t=p.Qb();p.Pb(0,"div",32),p.Pb(1,"a",35),p.Xb("click",(function(){return p.rc(t),p.Zb(2).editCard(!0)})),p.zc(2,"Edit"),p.Ob(),p.Pb(3,"a",33),p.Xb("click",(function(){return p.rc(t),p.Zb(2).deleteCard()})),p.Nb(4,"fa-icon",36),p.Ob(),p.Ob()}if(2&t){const t=p.Zb(2);p.Ab(4),p.fc("icon",t.trash)}}function k(t,c){if(1&t){const t=p.Qb();p.Pb(0,"div",4),p.Pb(1,"div",5),p.Pb(2,"div",6),p.Pb(3,"div",7),p.Pb(4,"div",8),p.Pb(5,"div",9),p.Pb(6,"div",6),p.xc(7,h,2,1,"span",10),p.xc(8,O,4,4,"div",11),p.Ob(),p.Pb(9,"div",12),p.Pb(10,"ul",13),p.Pb(11,"li",14),p.Pb(12,"span",15),p.zc(13,"Column"),p.Ob(),p.Pb(14,"span",16),p.zc(15),p.Ob(),p.Ob(),p.Pb(16,"li",14),p.Pb(17,"span",15),p.zc(18,"Assignee"),p.Ob(),p.Pb(19,"span",16),p.xc(20,v,2,1,"span",17),p.xc(21,P,2,0,"span",18),p.Ob(),p.Ob(),p.Pb(22,"li",19),p.Xb("onHidden",(function(){return p.rc(t),p.Zb().updateCardLabels()})),p.Pb(23,"span",15),p.zc(24,"Labels"),p.Ob(),p.Pb(25,"span",16),p.xc(26,A,2,0,"span",18),p.Ob(),p.Ob(),p.Pb(27,"li",20),p.Pb(28,"span",15),p.zc(29,"Updated"),p.Ob(),p.Pb(30,"span",21),p.ac(31,"date"),p.xc(32,x,3,4,"span",17),p.xc(33,z,2,0,"span",18),p.Ob(),p.Ob(),p.Pb(34,"li",20),p.Pb(35,"span",15),p.zc(36,"Created"),p.Ob(),p.Pb(37,"span",22),p.ac(38,"date"),p.zc(39),p.ac(40,"date"),p.Ob(),p.Ob(),p.Ob(),p.Ob(),p.Ob(),p.Ob(),p.Pb(41,"div",23),p.xc(42,C,5,1,"div",24),p.xc(43,I,5,1,"div",24),p.Ob(),p.Ob(),p.Ob(),p.Ob(),p.Ob()}if(2&t){const t=p.Zb(),c=p.pc(2),e=p.pc(6),i=p.pc(4);p.Ab(7),p.fc("ngIf",!t.isEditing),p.Ab(1),p.fc("ngIf",t.isEditing),p.Ab(3),p.fc("popover",c),p.Ab(4),p.Ac(t.card.column.name),p.Ab(1),p.fc("popover",e),p.Ab(4),p.fc("ngIf",t.getUser(t.card.assignee)),p.Ab(1),p.fc("ngIf",!t.getUser(t.card.assignee)),p.Ab(1),p.fc("popover",i),p.Ab(4),p.fc("ngIf",!t.card.labels),p.Ab(4),p.fc("tooltip",p.bc(31,17,t.card.updated))("isDisabled",t.card.created===t.card.updated),p.Ab(2),p.fc("ngIf",t.card.created!==t.card.updated),p.Ab(1),p.fc("ngIf",t.card.created===t.card.updated),p.Ab(4),p.fc("tooltip",p.bc(38,19,t.card.updated)),p.Ab(2),p.Ac(p.cc(40,21,t.card.created,"hh:MM a")),p.Ab(3),p.fc("ngIf",t.isEditing),p.Ab(1),p.fc("ngIf",!t.isEditing)}}function Z(t,c){if(1&t){const t=p.Qb();p.Pb(0,"li",39),p.Pb(1,"a",40),p.Xb("click",(function(){p.rc(t);const e=c.$implicit;return p.Zb(2).update({column:e.id})})),p.zc(2),p.Ob(),p.Ob()}if(2&t){const t=c.$implicit,e=p.Zb(2);p.Ab(1),p.Eb("active",e.card.column.id===t.id),p.Ab(1),p.Bc(" ",t.name," ")}}function y(t,c){if(1&t&&(p.Pb(0,"ul",37),p.xc(1,Z,3,3,"li",38),p.Ob()),2&t){const t=p.Zb();p.Ab(1),p.fc("ngForOf",t.columns)}}function E(t,c){if(1&t&&p.Nb(0,"fa-icon",42),2&t){const t=p.Zb(3);p.fc("icon",t.check)}}function w(t,c){if(1&t&&(p.Pb(0,"li",39),p.Pb(1,"a",40),p.Xb("click",(function(){const t=c.$implicit;return t.selected=!t.selected})),p.zc(2),p.xc(3,E,1,1,"fa-icon",41),p.Ob(),p.Ob()),2&t){const t=c.$implicit,e=p.Zb(2);p.Ab(1),p.Eb("active",t.selected)("disabled",e.loading),p.Ab(1),p.Bc(" ",t.name," "),p.Ab(1),p.fc("ngIf",t.selected)}}function X(t,c){if(1&t&&(p.Pb(0,"ul",37),p.xc(1,w,4,6,"li",38),p.Ob()),2&t){const t=p.Zb();p.Ab(1),p.fc("ngForOf",t.labels)}}function M(t,c){if(1&t){const t=p.Qb();p.Pb(0,"li",39),p.Pb(1,"a",40),p.Xb("click",(function(){p.rc(t);const e=c.$implicit;return p.Zb(2).update({assignee:e.id})})),p.zc(2),p.Ob(),p.Ob()}if(2&t){const t=c.$implicit,e=p.Zb(2);p.Ab(1),p.Eb("active",e.getUser(e.card.assignee)&&e.getUser(e.card.assignee).id===t.id)("disabled",e.loading),p.Ab(1),p.Bc(" ",t.username," ")}}function N(t,c){if(1&t){const t=p.Qb();p.Pb(0,"ul",37),p.Pb(1,"li",39),p.Pb(2,"a",40),p.Xb("click",(function(){return p.rc(t),p.Zb().update({assignee:null})})),p.zc(3,"None"),p.Ob(),p.Ob(),p.xc(4,M,3,5,"li",38),p.Ob()}if(2&t){const t=p.Zb();p.Ab(2),p.Eb("active",!t.getUser(t.card.assignee)),p.Ab(2),p.fc("ngForOf",t.users)}}function R(){return Object.assign(new b.g,{placement:"left",outsideClick:!0})}let D=(()=>{class t extends d.a{constructor(t,c,e,i){super(),this.activatedRoute=t,this.router=c,this.changeDetectorRef=e,this.apiService=i,this.trash=u.faTrash,this.check=f.faCheck,this.loading=!1,this.labels=[],this.content=new n.d("",n.t.required)}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.apiService.getCard(t.card).subscribe(t=>{this.card=t,this.content.setValue(t.content),o.a.labels.subscribe(t=>{this.labels=t||[],this.labels.forEach(t=>{const c=this.card.labels.find(c=>c.label===t.id);t.selected=!!c})}),this.apiService.getColumns(null,this.card.column.project).subscribe(t=>{this.columns=t})})})}update(t){this.loading=!0,this.apiService.updateCard(this.card.id,t).subscribe(()=>{this.loading=!1,this.apiService.getCard(this.card.id).subscribe(t=>{this.card=t,this.content.setValue(t.content)})})}deleteCard(){confirm("Delete card?\nThis action is not undoable.")&&(this.loading=!0,this.apiService.deleteCard(this.card.id).subscribe(()=>{this.router.navigate(["organization",this.activatedRoute.parent.snapshot.params.id],{queryParams:{project:this.card.column.project}})},()=>{this.loading=!1}))}editCard(t){this.isEditing=t,t?(this.changeDetectorRef.detectChanges(),this.contentInput.nativeElement.focus()):this.content.setValue(this.card.content)}updateCardLabels(){this.labels.forEach(t=>{const c=this.card.labels.find(c=>c.label===t.id);t.selected&&!c?this.apiService.assignLabel(r.CARD,this.card.id,t.id).subscribe(t=>{this.card.labels.push({label:t.label,id:t.id})}):!t.selected&&c&&this.apiService.deAttachLabel(c.id).subscribe(()=>{this.card.labels.splice(this.card.labels.indexOf(c),1)})})}}return t.\u0275fac=function(c){return new(c||t)(p.Mb(a.a),p.Mb(a.c),p.Mb(p.h),p.Mb(l.a))},t.\u0275cmp=p.Gb({type:t,selectors:[["app-card"]],viewQuery:function(t,c){var e;1&t&&p.Cc(g,!0),2&t&&p.oc(e=p.Yb())&&(c.contentInput=e.first)},features:[p.zb([{provide:b.g,useFactory:R}]),p.xb],decls:7,vars:1,consts:[["class","container",4,"ngIf"],["columnPopover",""],["labelsPopover",""],["userPopover",""],[1,"container"],[1,"row","justify-content-center"],[1,"col-md-8"],[1,"card","my-3"],[1,"card-body"],[1,"row"],["class","white-space-pre",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"col-md-4"],[1,"list-group"],[1,"list-group-item","list-group-item-action",3,"popover"],[1,"badge","badge-light"],[1,"float-right"],[4,"ngIf"],["class","text-secondary",4,"ngIf"],[1,"list-group-item","list-group-item-action",3,"popover","onHidden"],[1,"list-group-item"],[1,"float-right",3,"tooltip","isDisabled"],[1,"float-right",3,"tooltip"],[1,"card-footer"],["class","text-right",4,"ngIf"],[1,"white-space-pre"],[1,"form-group"],["name","content","rows","10",1,"form-control",3,"formControl"],["contentInput",""],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"text-secondary"],[1,"text-right"],[1,"btn","btn-link","text-secondary",3,"click"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-link",3,"click"],[3,"icon"],[1,"nav","nav-pills","flex-column"],["class","nav-item",4,"ngFor","ngForOf"],[1,"nav-item"],[1,"nav-link",3,"click"],["class","float-right ml-2","size","sm",3,"icon",4,"ngIf"],["size","sm",1,"float-right","ml-2",3,"icon"]],template:function(t,c){1&t&&(p.xc(0,k,44,24,"div",0),p.xc(1,y,2,1,"ng-template",null,1,p.yc),p.xc(3,X,2,1,"ng-template",null,2,p.yc),p.xc(5,N,5,3,"ng-template",null,3,p.yc)),2&t&&p.fc("ngIf",c.isOrganizationInitialised&&c.card)},directives:[i.l,b.h,b.j,n.b,n.l,n.e,s.a,i.k],pipes:[i.e],styles:[""]}),t})();e.d(c,"CardModule",(function(){return L}));const j=[{path:"",component:D}];let L=(()=>{class t{}return t.\u0275mod=p.Kb({type:t}),t.\u0275inj=p.Jb({factory:function(c){return new(c||t)},imports:[[i.c,a.e.forChild(j),b.i.forRoot(),b.k.forRoot(),n.q,s.b]]}),t})()},"8B4y":function(t,c,e){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var i=[],n="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z";c.definition={prefix:"fas",iconName:"check",icon:[512,512,i,"f00c",n]},c.faCheck=c.definition,c.prefix="fas",c.iconName="check",c.width=512,c.height=512,c.ligatures=i,c.unicode="f00c",c.svgPathData=n}}]);